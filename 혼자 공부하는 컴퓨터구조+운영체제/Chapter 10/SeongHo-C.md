<!--
bold 처리
** **

js 코드 작성
```js

```

링크
[보여질 단어](URL 주소)

형광펜 처리
` `
-->

## Chapter 10: 프로세스와 스레드

<details>
<summary>Table of Contents</summary>

- 프로세스 개요[:link:](#프로세스-개요)
  - 프로세스 직접 확인하기[:link:](#프로세스-직접-확인하기)
  - 프로세스 제어 블록[:link:](#프로세스-제어-블록)
  - 문맥 교환[:link:](#문맥-교환)
  - 프로세스의 메모리 영역[:link:](#프로세스의-메모리-영역)
  </details>

### 프로세스 개요

#### 프로세스 직접 확인하기

- 사용자가 보는 앞에서 실행되는 프로세스라는 점에서 `포그라운드 프로세스`라고 하고, 사용자가 보지 못하는 뒤편에서 실행되는 프로세스라는 점에서 `백그라운드 프로세스`라고 한다.
- 사용자와 직접 상호작용할 수 있는 백그라운드 프로세스도 있지만, 사용자와 상호작용하지 않고 그저 묵묵히 정해진 일만 수행하는 백그라운드 프로세스`(유닉스-데몬, 윈도우-서비스)`도 있다.

#### 프로세스 제어 블록

- 운영체제는 빠르게 번갈아 수행되는 프로세스의 실행 순서를 관리하고, 프로세스에 CPU를 비롯한 자원을 배분한다. 이를 위해 운영체제는 프로세스 제어 블록`(이하 PCB)`을 이용한다.
- PCB는 프로세스와 관련된 정보를 저장하는 자료 구조로 커널 영역에 생성된다.
- PCB는 프로세스 생성 시에 만들어지고 실행이 끝나면 폐기된다.
- PCB에 담기는 대표적인 정보로 프로세스 ID(PID), 레지스터 값, 프로세스 상태, CPU 스케줄링 정보, 메모리 관리 정보, 사용한 파일과 입출력장치 목록이 있다.

#### 문맥 교환

- 프로그램 카운터를 비롯한 각종 레지스터 값, 메모리 정보, 실행을 위해 열었던 파일이나 사용한 입출력장치 등의 중간 정보, 즉 하나의 프로세스 수행을 재개하기 위해 기억해야 할 정보를 `문맥`이라고 한다.
- 프로세스가 CPU를 사용할 수 있는 시간이 다 되거나 예기치 못한 상황이 발생하여 인터럽트가 발생하면 운영체제는 해당 프로세스의 PCB에 문맥을 백업한다. 그리고 뒤이어 실행할 프로세스의 문맥을 복구한다. 이를 `문맥 교환`이라고 한다.
- 문맥 교환은 여러 프로세스가 끊임없이 빠르게 번갈아 가며 실행되는 원리이다. 문맥 교환이 자주 일어나면 프로세스들이 동시에 실행되는 것처럼 보인다.`(오버헤드 주의❗️)`

#### 프로세스의 메모리 영역

하나의 프로세스는 **사용자 영역**에 크게 `코드 영역`, `데이터 영역`, `힙 영역`, `스택 영역`으로 나뉘어 저장된다.

1️⃣ 코드 영역(텍스트 영역)

- 실행할 수 있는 코드, 즉 기계어로 이루어진 명령어가 저장된다.
- 데이터가 아닌 CPU가 실행할 명령어가 담겨 있기 때문에 쓰기가 금지되어 있다.

2️⃣ 데이터 영역

- 프로그램이 실행되는 동안 유지할 데이터가 저장되는 공간이다. 이런 데이터로는 `전역 변수`가 대표적이다.
- 코드 영역과 데이터 영역은 '크기가 고정된 영역'이라는 점에서 `정적 할당 영역`이라고 부른다.

3️⃣ 힙 영역

- 프로그램을 만드는 사용자, 즉 프로그래머가 직접 할당할 수 있는 저장 공간이다.
- 프로그래밍 과정에서 힙 영역에 메모리 공간을 할당했다면 언젠가는 해당 공간을 반환해야 한다.
- 메모리 공간을 반환하지 않는다면 할당한 공간은 메모리 내에 계속 남아 메모리 낭비를 초래한다. 이런 문제를 `메모리 누수`라고 한다.

4️⃣ 스택 영역

- 데이터를 일시적으로 저장하는 공간이다. 이런 데이터로는 함수의 실행이 끝나면 사라지는 매개 변수, 지역 변수가 대표적이다.
- 일시적으로 저장할 데이터는 스택 영역에 PUSH되고, 더 이상 필요하지 않은 데이터는 POP됨으로써 스택 영역에서 사라진다.
- 힙 영역과 스택 영역은 실시간으로 그 크기가 변할 수 있기 때문에 `동적 할당 영역`이라고 부른다.
- 일반적으로 힙 영역은 메모리의 낮은 주소에서 높은 주소로 할당되고, 스택 영역은 높은 주소에서 낮은 주소로 할당 된다. 그래야만 힙 영역과 스택 영역에 데이터가 쌓여도 새롭게 할당되는 주소가 겹칠 일이 없다.
